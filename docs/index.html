
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WFH Kanban Board</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    h1 { margin-bottom: 2rem; }
    .day { margin-bottom: 2rem; }
    .columns { display: flex; gap: 1rem; }
    .column {
      flex: 1;
      padding: 1rem;
      background: #f9f9f9;
      border: 1px solid #ccc;
      border-radius: 8px;
      min-height: 200px;
    }
    .column h2 {
      margin-top: 0;
    }
    .card {
      padding: 0.5rem;
      margin: 0.5rem 0;
      background: white;
      border: 1px solid #ddd;
      border-radius: 4px;
      cursor: grab;
    }
  </style>
</head>
<body>
  <h1>WFH Booking Board (Interactive Demo)</h1>

  <div id="board"></div>

  <script>
    const staff = ["Alice", "Bob", "Charlie", "Dana", "Eli", "Frank", "Grace"];
    const days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"];
    const columns = ["In Office", "Working from Home", "On Annual Leave"];

    const board = document.getElementById("board");

    let state = {};

    days.forEach((day, dayIdx) => {
      const dayDiv = document.createElement("div");
      dayDiv.className = "day";
      const title = document.createElement("h2");
      title.textContent = day;
      dayDiv.appendChild(title);

      const cols = document.createElement("div");
      cols.className = "columns";

      columns.forEach((col) => {
        const colDiv = document.createElement("div");
        colDiv.className = "column";
        colDiv.dataset.day = dayIdx;
        colDiv.dataset.column = col;
        colDiv.addEventListener("dragover", (e) => e.preventDefault());
        colDiv.addEventListener("drop", (e) => {
          const name = e.dataTransfer.getData("text");
          moveCard(dayIdx, col, name);
        });

        const colTitle = document.createElement("h2");
        colTitle.textContent = col;
        colDiv.appendChild(colTitle);

        cols.appendChild(colDiv);
      });

      dayDiv.appendChild(cols);
      board.appendChild(dayDiv);
    });

    function moveCard(day, column, name) {
      state[day] = state[day] || {};
      columns.forEach((col) => {
        state[day][col] = (state[day][col] || []).filter((p) => p !== name);
      });

      if (column === "Working from Home") {
        const wfhCount = (state[day]["Working from Home"] || []).length;
        const alreadyWFH = Object.values(state).some(dayData =>
          (dayData["Working from Home"] || []).includes(name)
        );
        if (wfhCount >= 3 || alreadyWFH) {
          alert("Cannot move: WFH limit reached or already WFH this week.");
          return;
        }
      }

      state[day][column] = state[day][column] || [];
      state[day][column].push(name);
      render();
    }

    function render() {
      document.querySelectorAll(".column").forEach((col) => {
        const day = col.dataset.day;
        const column = col.dataset.column;
        col.querySelectorAll(".card")?.forEach((el) => el.remove());
        const cards = (state[day]?.[column] || []).map((name) => {
          const card = document.createElement("div");
          card.className = "card";
          card.draggable = true;
          card.textContent = name;
          card.addEventListener("dragstart", (e) => {
            e.dataTransfer.setData("text", name);
          });
          return card;
        });
        cards.forEach((c) => col.appendChild(c));
      });
    }

    // Initial population
    staff.forEach((person, idx) => {
      moveCard(idx % 5, "In Office", person);
    });
  </script>
</body>
</html>
